(this.webpackJsonpkraken=this.webpackJsonpkraken||[]).push([[0],{278:function(e,t,n){},285:function(e,t){},287:function(e,t){},453:function(e,t,n){"use strict";n.r(t);var a=n(14),o=n(0),c=n.n(o),s=n(34),i=n.n(s),r=(n(278),n(239)),l=n(175),u=n(241),m=n(242),p=n(106),d=n(270),h=n(269),j=n(467),b=n(466),g=(n(279),n(280),n(243)),f=n.n(g),x=n(469),O=n(465),v=n(471),y=n(462),S=n(47),k=j.a.Option,C=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(u.a)(this,n),(a=t.call(this,e)).enterLoading=function(){Object(p.a)(a);a.state.socket.connect(),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){var t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaStreamSource(e),o=t.createScriptProcessor(4096,1,1);a.state.socket.emit("sample_rate",t.sampleRate),o.onaudioprocess=function(e){var n=e.inputBuffer.getChannelData(0),o={};n.forEach((function(e,t){o[t]=e})),a.state.socket.emit("send_audio",o),a.setState({lenSamples:a.state.lenSamples+1}),a.state.lenSamples>=1*t.sampleRate/4096&&(a.setState({lenSamples:0}),a.state.socket.emit("tempo",a.state.song,!0))},a.state.socket.on("output local tempo",(function(e){var t=e.tempo,n=e.volume,o=e.p_volumes,c=e.p_tempos;a.setState({tempoData:[].concat(Object(l.a)(a.state.tempoData),[{x:1*a.state.tempoData.length,y:t}]),volumeData:[].concat(Object(l.a)(a.state.volumeData),[{x:1*a.state.volumeData.length,y:n}]),tempoVolume:[{x:t,y:n}],pTempoVolumes:{p_volumes:o,p_tempos:c}})})),a.state.socket.on("output global tempo",(function(e){var t=e.tempo,n=e.volume;a.setState({globalTempo:t+" BPM",globalVolume:n+"db"})})),n.connect(o),o.connect(t.destination),a.setState({source:n,node:o})}))},a.stop=function(){a.state.source&&(a.state.node.disconnect(),a.state.source.disconnect(),a.setState({source:null,node:null}))},a.pieceChange=function(e){console.log(e),a.setState({song:e})},a.windowChange=function(){},a.getColors=function(e){return[[S.magenta.primary,"Magenta"],[S.cyan.primary,"Cyan"],[S.yellow.primary,"Yellow"],[S.orange.primary,"Orange"],[S.green.primary,"Green"]]};var o=f()("http://localhost:5000/test");return a.state={started:!1,microphone:null,socket:o,lenSamples:0,globalTempo:"none",globalVolume:"none",tempoData:[],volumeData:[],tempoVolume:[{x:0,y:0}],pTempoVolumes:null,song:"Prelude in E Minor",printed:!1},a.pieceChange=a.pieceChange.bind(Object(p.a)(a)),a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("http://localhost:5000/songs").then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({songs:t})}))}},{key:"render",value:function(){var e=this,t=[Object(a.jsx)(x.a,{style:{data:{fill:S.blue.primary},parent:{border:"1px solid #ccc"}},data:this.state.tempoVolume,labels:function(e){return Object(r.a)(e),"Me"}},"1")];return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"main-container",children:[Object(a.jsxs)("div",{className:"info-container",children:[Object(a.jsx)("h3",{children:"Tempo(BPM)"}),Object(a.jsx)(O.a,{theme:v.a.material,children:Object(a.jsx)(y.a,{domain:{y:[80,160]},style:{data:{stroke:S.blue.primary},parent:{border:"1px solid #ccc"}},data:this.state.tempoData})}),Object(a.jsx)("h3",{children:"Volume(db)"}),Object(a.jsx)(O.a,{theme:v.a.material,domain:{y:[70,100]},children:Object(a.jsx)(y.a,{style:{data:{stroke:S.blue.primary},parent:{border:"1px solid #ccc"}},data:this.state.volumeData})}),Object(a.jsx)(O.a,{theme:v.a.material,domain:{x:[80,160],y:[70,100]},children:t})]}),Object(a.jsx)("div",{className:"flex-row",children:Object(a.jsxs)("div",{className:"center-console",children:[Object(a.jsx)(b.a,{type:"primary",onClick:function(){return e.enterLoading()},children:"Start"}),Object(a.jsx)(b.a,{type:"danger",onClick:function(){return e.stop()},children:"Stop"}),Object(a.jsxs)(j.a,{defaultValue:"Prelude in E Minor",style:{width:300},onChange:this.pieceChange,children:[Object(a.jsx)(k,{value:"Widmung",children:"Schumann-Liszt Widmung"}),Object(a.jsx)(k,{value:"Prelude in E Minor",children:"Chopin Prelude in E Minor"}),Object(a.jsx)(k,{value:"Fantasie Impromptu",children:"Chopin Fantasie Impromptu"})]})]})})]})})}}]),n}(c.a.Component),w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,473)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),o(e),c(e),s(e)}))};i.a.render(Object(a.jsxs)(c.a.StrictMode,{children:[Object(a.jsx)("div",{className:"app-header"}),Object(a.jsx)(C,{})]}),document.getElementById("root")),w()}},[[453,1,2]]]);
//# sourceMappingURL=main.6e5b078e.chunk.js.map