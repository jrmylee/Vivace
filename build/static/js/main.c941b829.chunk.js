(this.webpackJsonpkraken=this.webpackJsonpkraken||[]).push([[0],{277:function(e,t,a){},284:function(e,t){},286:function(e,t){},452:function(e,t,a){"use strict";a.r(t);var n=a(13),o=a(0),c=a.n(o),l=a(33),s=a.n(l),i=(a(277),a(236)),r=a(172),u=a(238),p=a(239),m=a(104),d=a(269),j=a(268),b=a(463),h=a(462),O=(a(278),a(279),a(240)),x=a.n(O),v=a(466),g=a(464),f=a(468),y=a(470),C=a(467),S=a(65),k=b.a.Option,w=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var n;Object(u.a)(this,a),(n=t.call(this,e)).enterLoading=function(){Object(m.a)(n);n.state.socket.connect(),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){var t=new(window.AudioContext||window.webkitAudioContext),a=t.createMediaStreamSource(e),o=t.createScriptProcessor(4096,1,1);n.state.socket.emit("sample_rate",t.sampleRate),o.onaudioprocess=function(e){var a=e.inputBuffer.getChannelData(0),o={};a.forEach((function(e,t){o[t]=e})),n.state.socket.emit("send_audio",o),n.setState({lenSamples:n.state.lenSamples+1}),n.state.lenSamples>=1*t.sampleRate/4096&&(n.setState({lenSamples:0}),n.state.socket.emit("tempo",n.state.song,!0))},n.state.socket.on("output local tempo",(function(e){var t=e.tempo,a=e.volume,o=e.p_volume,c=e.p_tempo;n.setState({tempoData:[].concat(Object(r.a)(n.state.tempoData),[{x:1*n.state.tempoData.length,y:t}]),volumeData:[].concat(Object(r.a)(n.state.volumeData),[{x:1*n.state.volumeData.length,y:a}]),tempoVolume:[{x:t,y:a}],pTempoVolumes:{p_volume:o,p_tempo:c}})})),n.state.socket.on("output global tempo",(function(e){var t=e.tempo,a=e.volume;n.setState({globalTempo:t+" BPM",globalVolume:a+"db"})})),a.connect(o),o.connect(t.destination),n.setState({source:a,node:o})}))},n.stop=function(){n.state.source&&(n.state.node.disconnect(),n.state.source.disconnect(),n.setState({source:null,node:null}))},n.pieceChange=function(e){console.log(e),n.setState({song:e})},n.windowChange=function(){},n.getColors=function(e){return[[S.magenta.primary,"Magenta"],[S.cyan.primary,"Cyan"],[S.yellow.primary,"Yellow"],[S.orange.primary,"Orange"],[S.green.primary,"Green"]]};var o=x()("http://localhost:5000/test");return n.state={started:!1,microphone:null,socket:o,lenSamples:0,globalTempo:"none",globalVolume:"none",tempoData:[],volumeData:[],tempoVolume:[{x:0,y:0}],pTempoVolumes:null,song:"Gymnopedie",printed:!1},n.pieceChange=n.pieceChange.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=[Object(n.jsx)(v.a,{style:{data:{fill:S.blue.primary},parent:{border:"1px solid #ccc"}},data:this.state.tempoVolume,labels:function(e){return Object(i.a)(e),"Me"}},"1")];if(this.state.pTempoVolumes){console.log(this.state.pTempoVolumes);var a=this.getColors();Object.keys(this.state.pTempoVolumes.p_tempo).forEach((function(o,c){var l=e.state.pTempoVolumes.p_volume[o],s=[{x:e.state.pTempoVolumes.p_tempo[o],y:l,label:o}];t.push(Object(n.jsx)(v.a,{style:{data:{fill:a[c][0]},parent:{border:"1px solid #ccc"}},data:s,labels:function(e){return e.datum.label}},c))}))}return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"main-container",children:[Object(n.jsx)("div",{className:"info-container",children:Object(n.jsxs)(g.a,{theme:f.a.material,domain:{x:[50,200],y:[0,200]},children:[t,Object(n.jsx)(y.a,{dependentAxis:!0,label:"Volume(db)",axisLabelComponent:Object(n.jsx)(C.a,{dy:-30})}),Object(n.jsx)(y.a,{label:"Tempo(BPM)",axisLabelComponent:Object(n.jsx)(C.a,{dy:20})})]})}),Object(n.jsx)("div",{className:"flex-row",children:Object(n.jsxs)("div",{className:"center-console",children:[Object(n.jsx)(h.a,{type:"primary",onClick:function(){return e.enterLoading()},children:"Start"}),Object(n.jsx)(h.a,{type:"danger",onClick:function(){return e.stop()},children:"Stop"}),Object(n.jsxs)(b.a,{defaultValue:"Gymnopedie",style:{width:300},onChange:this.pieceChange,children:[Object(n.jsx)(k,{value:"Gymnopedie",children:"Satie Gymnopedie"}),Object(n.jsx)(k,{value:"Nocturne",children:"Chopin Nocturne Op. 9 No. 2"}),Object(n.jsx)(k,{value:"Waltz 64 2",children:"Chopin Waltz Op. 64 No. 2"}),Object(n.jsx)(k,{value:"Waltz 69 1",children:"Chopin Waltz Op. 69 No. 1"}),Object(n.jsx)(k,{value:"Waltz 69 2",children:"Chopin Waltz Op. 69 No. 2"}),Object(n.jsx)(k,{value:"Impromptu No 3",children:"Schubert Impromptu No. 3"}),Object(n.jsx)(k,{value:"Waltz A Minor",children:"Chopin Waltz in Am"}),Object(n.jsx)(k,{value:"Fur Elise",children:"Beethoven Fur Elise"}),Object(n.jsx)(k,{value:"Traumerei",children:"Schumann Traumerei"}),Object(n.jsx)(k,{value:"Sonata",children:"Mozart Sonata in C K.545"}),Object(n.jsx)(k,{value:"Minuet in F",children:"Bach Minuet in F"})]})]})})]})})}}]),a}(c.a.Component),T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,472)).then((function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,c=t.getLCP,l=t.getTTFB;a(e),n(e),o(e),c(e),l(e)}))};s.a.render(Object(n.jsxs)(c.a.StrictMode,{children:[Object(n.jsx)("div",{className:"app-header"}),Object(n.jsx)(w,{})]}),document.getElementById("root")),T()}},[[452,1,2]]]);
//# sourceMappingURL=main.c941b829.chunk.js.map