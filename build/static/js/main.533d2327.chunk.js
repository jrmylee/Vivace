(this.webpackJsonpkraken=this.webpackJsonpkraken||[]).push([[0],{276:function(e,t,n){},283:function(e,t){},285:function(e,t){},451:function(e,t,n){"use strict";n.r(t);var a=n(16),o=n(0),s=n.n(o),c=n(33),i=n.n(c),l=(n(276),n(236)),r=n(172),u=n(238),p=n(239),m=n(104),d=n(268),h=n(267),b=n(463),j=n(462),g=(n(277),n(278),n(240)),f=n.n(g),v=n(465),O=n(461),x=n(467),y=n(65),C=b.a.Option,S=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(u.a)(this,n),(a=t.call(this,e)).enterLoading=function(){Object(m.a)(a);a.state.socket.connect(),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){var t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaStreamSource(e),o=t.createScriptProcessor(4096,1,1);a.state.socket.emit("sample_rate",t.sampleRate),o.onaudioprocess=function(e){var n=e.inputBuffer.getChannelData(0),o={};n.forEach((function(e,t){o[t]=e})),a.state.socket.emit("send_audio",o),a.setState({lenSamples:a.state.lenSamples+1}),a.state.lenSamples>=1*t.sampleRate/4096&&(a.setState({lenSamples:0}),a.state.socket.emit("tempo",a.state.song,!0))},a.state.socket.on("output local tempo",(function(e){var t=e.tempo,n=e.volume,o=e.p_volume,s=e.p_tempo;a.setState({tempoData:[].concat(Object(r.a)(a.state.tempoData),[{x:1*a.state.tempoData.length,y:t}]),volumeData:[].concat(Object(r.a)(a.state.volumeData),[{x:1*a.state.volumeData.length,y:n}]),tempoVolume:[{x:t,y:n}],pTempoVolumes:{p_volume:o,p_tempo:s}})})),a.state.socket.on("output global tempo",(function(e){var t=e.tempo,n=e.volume;a.setState({globalTempo:t+" BPM",globalVolume:n+"db"})})),n.connect(o),o.connect(t.destination),a.setState({source:n,node:o})}))},a.stop=function(){a.state.source&&(a.state.node.disconnect(),a.state.source.disconnect(),a.setState({source:null,node:null}))},a.pieceChange=function(e){console.log(e),a.setState({song:e})},a.windowChange=function(){},a.getColors=function(e){return[[y.magenta.primary,"Magenta"],[y.cyan.primary,"Cyan"],[y.yellow.primary,"Yellow"],[y.orange.primary,"Orange"],[y.green.primary,"Green"]]};var o=f()("http://localhost:5000/test");return a.state={started:!1,microphone:null,socket:o,lenSamples:0,globalTempo:"none",globalVolume:"none",tempoData:[],volumeData:[],tempoVolume:[{x:0,y:0}],pTempoVolumes:null,song:"Prelude in E Minor",printed:!1},a.pieceChange=a.pieceChange.bind(Object(m.a)(a)),a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=[Object(a.jsx)(v.a,{style:{data:{fill:y.blue.primary},parent:{border:"1px solid #ccc"}},data:this.state.tempoVolume,labels:function(e){return Object(l.a)(e),"Me"}},"1")];if(this.state.pTempoVolumes){console.log(this.state.pTempoVolumes);var n=this.getColors();Object.keys(this.state.pTempoVolumes.p_tempo).forEach((function(o,s){var c=e.state.pTempoVolumes.p_volume[o],i=[{x:e.state.pTempoVolumes.p_tempo[o],y:c,label:o}];t.push(Object(a.jsx)(v.a,{style:{data:{fill:n[s][0]},parent:{border:"1px solid #ccc"}},data:i,labels:function(e){return e.datum.label}},s))}))}return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"main-container",children:[Object(a.jsx)("div",{className:"info-container",children:Object(a.jsx)(O.a,{theme:x.a.material,domain:{x:[80,160],y:[70,100]},children:t})}),Object(a.jsx)("div",{className:"flex-row",children:Object(a.jsxs)("div",{className:"center-console",children:[Object(a.jsx)(j.a,{type:"primary",onClick:function(){return e.enterLoading()},children:"Start"}),Object(a.jsx)(j.a,{type:"danger",onClick:function(){return e.stop()},children:"Stop"}),Object(a.jsxs)(b.a,{defaultValue:"Prelude in E Minor",style:{width:300},onChange:this.pieceChange,children:[Object(a.jsx)(C,{value:"Widmung",children:"Schumann-Liszt Widmung"}),Object(a.jsx)(C,{value:"Prelude in E Minor",children:"Chopin Prelude in E Minor"}),Object(a.jsx)(C,{value:"Fantasie Impromptu",children:"Chopin Fantasie Impromptu"})]})]})})]})})}}]),n}(s.a.Component),k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,469)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),o(e),s(e),c(e)}))};i.a.render(Object(a.jsxs)(s.a.StrictMode,{children:[Object(a.jsx)("div",{className:"app-header"}),Object(a.jsx)(S,{})]}),document.getElementById("root")),k()}},[[451,1,2]]]);
//# sourceMappingURL=main.533d2327.chunk.js.map